<div [class]="{ opened: isOpened, closed: !isOpened }" class="card">
  <div class="w-full flex items-center justify-between">
    <div class="flex flex-col">
      <h3 class="text-gray-700 text-[16px] !mb-[0]">{{ idea?.title }}</h3>
      <div>
        <span class="text-gray-500 text-sm"
          >{{ idea?.user?.firstName || 'Falonchi' }} {{ idea?.user?.lastName || 'Pistonchiyev' }}</span
        >
        <span class="bg-green-100 ml-3 text-gray-400 text-sm rounded-full px-3 py-1">{{
          idea?.category?.name || 'Umumiy kategoriya'
        }}</span>
      </div>
    </div>

    <div>
      <button
        (click)="isOpened = !isOpened"
        class="rounded-[6px] py-2 px-3 bg-gray-100 flex justify-center items-center"
        matRipple
      >
        <mat-icon>
          {{ isOpened ? 'keyboard_arrow_down' : 'keyboard_arrow_up' }}
        </mat-icon>
      </button>
    </div>
  </div>

  <p class="w-full overflow-auto flex justify-start text-gray-700 text-sm h-44">{{ idea?.description }}</p>

  <hr />

  <div class="w-full flex items-center justify-end">
    @if (idea?.user?.id == currentUserId) {
      <button
        (click)="deleteIdea()"
        class="rounded-[6px] py-2 px-6 flex justify-center items-center bg-gray-100 mr-1"
        matRipple
      >
        <svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="25" height="25" viewBox="0 0 48 48">
          <path
            d="M 24 4 C 20.491685 4 17.570396 6.6214322 17.080078 10 L 10.238281 10 A 1.50015 1.50015 0 0 0 9.9804688 9.9785156 A 1.50015 1.50015 0 0 0 9.7578125 10 L 6.5 10 A 1.50015 1.50015 0 1 0 6.5 13 L 8.6386719 13 L 11.15625 39.029297 C 11.427329 41.835926 13.811782 44 16.630859 44 L 31.367188 44 C 34.186411 44 36.570826 41.836168 36.841797 39.029297 L 39.361328 13 L 41.5 13 A 1.50015 1.50015 0 1 0 41.5 10 L 38.244141 10 A 1.50015 1.50015 0 0 0 37.763672 10 L 30.919922 10 C 30.429604 6.6214322 27.508315 4 24 4 z M 24 7 C 25.879156 7 27.420767 8.2681608 27.861328 10 L 20.138672 10 C 20.579233 8.2681608 22.120844 7 24 7 z M 11.650391 13 L 36.347656 13 L 33.855469 38.740234 C 33.730439 40.035363 32.667963 41 31.367188 41 L 16.630859 41 C 15.331937 41 14.267499 40.033606 14.142578 38.740234 L 11.650391 13 z M 20.476562 17.978516 A 1.50015 1.50015 0 0 0 19 19.5 L 19 34.5 A 1.50015 1.50015 0 1 0 22 34.5 L 22 19.5 A 1.50015 1.50015 0 0 0 20.476562 17.978516 z M 27.476562 17.978516 A 1.50015 1.50015 0 0 0 26 19.5 L 26 34.5 A 1.50015 1.50015 0 1 0 29 34.5 L 29 19.5 A 1.50015 1.50015 0 0 0 27.476562 17.978516 z"
            fill="#3A4A51"
          ></path>
        </svg>
      </button>

      <button class="rounded-[6px] py-2 px-6 flex justify-center items-center bg-gray-100" matRipple>
        <svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="25" height="25" viewBox="0 0 26 26">
          <path
            d="M 20.09375 0.25 C 19.5 0.246094 18.917969 0.457031 18.46875 0.90625 L 17.46875 1.9375 L 24.0625 8.5625 L 25.0625 7.53125 C 25.964844 6.628906 25.972656 5.164063 25.0625 4.25 L 21.75 0.9375 C 21.292969 0.480469 20.6875 0.253906 20.09375 0.25 Z M 16.34375 2.84375 L 14.78125 4.34375 L 21.65625 11.21875 L 23.25 9.75 Z M 13.78125 5.4375 L 2.96875 16.15625 C 2.71875 16.285156 2.539063 16.511719 2.46875 16.78125 L 0.15625 24.625 C 0.0507813 24.96875 0.144531 25.347656 0.398438 25.601563 C 0.652344 25.855469 1.03125 25.949219 1.375 25.84375 L 9.21875 23.53125 C 9.582031 23.476563 9.882813 23.222656 10 22.875 L 20.65625 12.3125 L 19.1875 10.84375 L 8.25 21.8125 L 3.84375 23.09375 L 2.90625 22.15625 L 4.25 17.5625 L 15.09375 6.75 Z M 16.15625 7.84375 L 5.1875 18.84375 L 6.78125 19.1875 L 7 20.65625 L 18 9.6875 Z"
            fill="#3A4A51"
          ></path>
        </svg>
      </button>
    } @else {
      <button
        (click)="saveIdea()"
        class="rounded-full p-[10px]  mr-3 border-gray-300 border
       {{ isIdeaSaved ? 'bg-[#02BF67] ' : '' }} flex justify-center items-center"
        matRipple
      >
        <svg fill="none" height="22" viewBox="0 0 20 22" width="20" xmlns="http://www.w3.org/2000/svg">
          <path
            d="M7 4.25C6.58579 4.25 6.25 4.58579 6.25 5C6.25 5.41421 6.58579 5.75 7 5.75L13 5.75C13.4142 5.75 13.75 5.41421 13.75 5C13.75 4.58579 13.4142 4.25 13 4.25L7 4.25Z"
            fill="#344054"
            [attr.fill]="isIdeaSaved ? '#fff' : '#000'"
          />
          <path
            clip-rule="evenodd"
            d="M9.9425 0.25C7.86994 0.249986 6.23716 0.249974 4.96128 0.42337C3.65122 0.601412 2.60609 0.974684 1.78484 1.80484C0.964694 2.63387 0.596919 3.68702 0.4213 5.00741C0.249976 6.29551 0.249987 7.94462 0.25 10.0411L0.25 15.139C0.249989 16.6466 0.249981 17.8402 0.34601 18.7388C0.44091 19.6269 0.644473 20.428 1.22584 20.9638C1.69226 21.3937 2.28211 21.6646 2.91165 21.7367C3.69912 21.8268 4.43439 21.4508 5.15868 20.9377C5.89163 20.4185 6.78075 19.6321 7.90254 18.6399L7.93905 18.6076C8.45912 18.1476 8.81122 17.8372 9.10499 17.6224C9.38892 17.4148 9.56227 17.3397 9.70838 17.3103C9.90092 17.2715 10.0991 17.2715 10.2916 17.3103C10.4377 17.3397 10.6111 17.4148 10.895 17.6224C11.1888 17.8372 11.5409 18.1476 12.061 18.6076L12.0975 18.64C13.2193 19.6321 14.1084 20.4186 14.8413 20.9377C15.5656 21.4508 16.3009 21.8268 17.0883 21.7367C17.7179 21.6646 18.3077 21.3937 18.7742 20.9638C19.3555 20.428 19.5591 19.6269 19.654 18.7388C19.75 17.8402 19.75 16.6466 19.75 15.139V10.041C19.75 7.94462 19.75 6.2955 19.5787 5.00741C19.4031 3.68702 19.0353 2.63387 18.2152 1.80484C17.3939 0.974684 16.3488 0.601412 15.0387 0.42337C13.7628 0.249974 12.1301 0.249986 10.0575 0.25H9.9425ZM2.8512 2.85977C3.34797 2.35762 4.02251 2.06474 5.16328 1.90971C6.32645 1.75163 7.85725 1.75 10 1.75C12.1427 1.75 13.6736 1.75163 14.8367 1.90971C15.9775 2.06474 16.652 2.35762 17.1488 2.85977C17.6467 3.36303 17.9379 4.04819 18.0918 5.20518C18.2484 6.38292 18.25 7.93223 18.25 10.0975V15.0909C18.25 16.6572 18.249 17.7702 18.1625 18.5794C18.0739 19.4088 17.9104 19.72 17.7576 19.8608C17.5238 20.0763 17.2298 20.2107 16.9178 20.2464C16.7182 20.2692 16.3835 20.192 15.7083 19.7137C15.0497 19.2472 14.2211 18.5157 13.0547 17.484L13.0286 17.4609C12.5413 17.0299 12.1372 16.6725 11.7804 16.4116C11.4074 16.1388 11.0312 15.9292 10.5878 15.8398C10.1998 15.7617 9.80022 15.7617 9.41218 15.8398C8.96876 15.9292 8.59259 16.1388 8.2196 16.4116C7.86283 16.6725 7.45871 17.0299 6.97146 17.4609L6.94527 17.484C5.77887 18.5157 4.95026 19.2472 4.29165 19.7137C3.61646 20.192 3.28182 20.2692 3.08218 20.2464C2.77019 20.2107 2.47617 20.0763 2.24237 19.8608C2.08963 19.72 1.92614 19.4088 1.83752 18.5794C1.75104 17.7702 1.75 16.6572 1.75 15.0909L1.75 10.0975C1.75 7.93223 1.75156 6.38292 1.90821 5.20518C2.06209 4.04819 2.35333 3.36303 2.8512 2.85977Z"
            fill="#344054"
            fill-rule="evenodd"
            [attr.fill]="isIdeaSaved ? '#fff' : '#000'"
          />
        </svg>
      </button>

      <button
        (click)="vote(false)"
        class="rounded-[6px] py-2 px-6 mr-3 flex justify-center items-center {{
          isUserVoted(idea?.votes) == 'DOWN' ? 'bg-[#02BF67]' : 'bg-gray-100'
        }}"
        matRipple
      >
        <span class="mr-2 text-sm {{ isUserVoted(idea?.votes) == 'DOWN' ? 'text-white' : 'text-[#344054]' }}">{{
          votes?.down
        }}</span>
        <svg fill="none" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
          <path
            d="M20.2699 8.48505L20.9754 12.5648C21.1516 13.5838 20.368 14.5158 19.335 14.5158H14.1539C13.6404 14.5158 13.2494 14.9767 13.3325 15.484L13.9952 19.5286C14.1028 20.1857 14.0721 20.858 13.9049 21.5025C13.7664 22.0364 13.3545 22.465 12.8128 22.6391L12.6678 22.6856C12.3404 22.7908 11.9831 22.7663 11.6744 22.6176C11.3347 22.4539 11.0861 22.1553 10.994 21.8001L10.5183 19.9663C10.3669 19.3828 10.1465 18.8195 9.86218 18.2874C9.44683 17.5098 8.80465 16.8875 8.13711 16.3123L6.69838 15.0725C6.29272 14.7229 6.07968 14.1994 6.12584 13.6656L6.93801 4.27293C7.0125 3.41139 7.7328 2.75 8.59658 2.75H13.2452C16.7265 2.75 19.6975 5.17561 20.2699 8.48505Z"
            [attr.fill]="isUserVoted(idea?.votes) == 'DOWN' ? '#fff' : '#344054'"
          />
          <path
            clip-rule="evenodd"
            d="M2.96767 15.2651C3.36893 15.2824 3.71261 14.9806 3.74721 14.5804L4.71881 3.34389C4.78122 2.6221 4.21268 2 3.48671 2C2.80289 2 2.25 2.55474 2.25 3.23726V14.5158C2.25 14.9174 2.5664 15.2478 2.96767 15.2651Z"
            [attr.fill]="isUserVoted(idea?.votes) == 'DOWN' ? '#fff' : '#344054'"
            fill-rule="evenodd"
          />
        </svg>
      </button>

      <button
        (click)="vote(true)"
        class="rounded-[6px] py-2 px-6 flex justify-center items-center {{
          isUserVoted(idea?.votes) == 'UP' ? 'bg-[#02BF67]' : 'bg-gray-100'
        }}"
        matRipple
      >
        <span class="mr-2 text-sm {{ isUserVoted(idea?.votes) == 'UP' ? 'text-white' : 'text-[#344054]' }}">{{
          votes?.up
        }}</span>
        <svg fill="none" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
          <path
            d="M20.2696 16.265L20.9751 12.1852C21.1514 11.1662 20.3677 10.2342 19.3348 10.2342H14.1537C13.6402 10.2342 13.2491 9.77328 13.3323 9.26598L13.9949 5.22142C14.1026 4.56435 14.0719 3.892 13.9047 3.24752C13.7662 2.71364 13.3543 2.28495 12.8126 2.11093L12.6676 2.06435C12.3402 1.95918 11.9829 1.98365 11.6742 2.13239C11.3344 2.29611 11.0859 2.59473 10.9938 2.94989L10.518 4.78374C10.3667 5.36723 10.1462 5.93045 9.86194 6.46262C9.44659 7.24017 8.8044 7.86246 8.13687 8.43769L6.69813 9.67749C6.29247 10.0271 6.07944 10.5506 6.1256 11.0844L6.93776 20.4771C7.01226 21.3386 7.73256 22 8.59634 22H13.245C16.7263 22 19.6973 19.5744 20.2696 16.265Z"
            [attr.fill]="isUserVoted(idea?.votes) == 'UP' ? '#fff' : '#344054'"
          />
          <path
            clip-rule="evenodd"
            d="M2.96767 9.48508C3.36893 9.46777 3.71261 9.76963 3.74721 10.1698L4.71881 21.4063C4.78122 22.1281 4.21268 22.7502 3.48671 22.7502C2.80289 22.7502 2.25 22.1954 2.25 21.5129V10.2344C2.25 9.83275 2.5664 9.5024 2.96767 9.48508Z"
            [attr.fill]="isUserVoted(idea?.votes) == 'UP' ? '#fff' : '#344054'"
            fill-rule="evenodd"
          />
        </svg>
      </button>
    }
  </div>
</div>
